"use strict";function isEmpty(t){if(null==t||void 0==t||""===t)return!0;if("object"==typeof t)for(var e in t)if("id"!=e&&!t[e])return!0;return!1}var siteUrl="json/",o2oApp=angular.module("o2oApp",["ngRoute","o2oServices","controllers"]);o2oApp.config(["$routeProvider","$locationProvider","$httpProvider",function(t,e,o){t.when("/",{templateUrl:"partials/main.html",controller:"MainCtrl"}).when("/shop/detail/:id",{templateUrl:"partials/shopDetail.html",controller:"ShopDetailCtrl"}).when("/shop/:id/0",{templateUrl:"partials/shop.html",controller:"ShopCtrl"}).when("/product/:id/:shopId",{templateUrl:"partials/product.html",controller:"ProductCtrl"}).when("/my/addresses",{templateUrl:"partials/addresses.html",controller:"AddressesCtrl"}).when("/my/address/:id",{templateUrl:"partials/address.html",controller:"AddressCtrl"}).when("/my/phone",{templateUrl:"partials/phone.html",controller:"MyPhoneCtrl"}).when("/addresses",{templateUrl:"partials/addresses2.html",controller:"AddressesCtrl2"}).when("/order",{templateUrl:"partials/order.html",controller:"OrderCtrl"}).when("/ordersuccess",{templateUrl:"partials/orderSuccess.html",controller:"OrderSuccessCtrl"}).when("/paysuccess",{templateUrl:"partials/paySuccess.html",controller:"PaySuccessCtrl"}).when("/my/orders",{templateUrl:"partials/myOrders.html",controller:"MyOrdersCtrl"}).when("/my/order/:id",{templateUrl:"partials/myOrder.html",controller:"MyOrderCtrl"}).when("/my/comment/:id",{templateUrl:"partials/comment.html",controller:"CommentCtrl"}).when("/about",{templateUrl:"partials/about.html",controller:"AboutCtrl"}).when("/declare",{templateUrl:"partials/declare.html",controller:"DeclareCtrl"}).otherwise({redirectTo:"/"}),e.html5Mode(!1).hashPrefix("!"),o.interceptors.push("ErrorInterceptors")}]).run(["$rootScope","$location",function(t,e){window._win=$(window),window._doc=$("body"),window.rootScope=t,t.apiURL=siteUrl,t.$on("$locationChangeStart",function(e){if(Utils.hideView(),t.showSideBar=t.showCartDetail=t.showSign=!1,t.cartShopId=-1,_win.unbind("scroll"),sessionStorage)try{sessionStorage.setItem("test","")}catch(t){alert("请取消无痕浏览！")}else alert("请升级浏览器！"),e.preventDefault()}),t.cancelSign=function(){t.showSign=!1,"/"!=e.path()&&history.go(-1)}}]),function(){var t=angular.module("controllers",[]);t.controller("MainCtrl",["$scope","GeoSvc","QuerySvc","$routeParams",function(t,e,o,r){var n=!1,s=0,i=null;$.extend(t,{data:[],cat2:{id:0,name:"全部分类"},sort2:{id:"DEFAULT",name:"默认排序"},delivery2:{id:1,name:"配送费不限"},showSub:0,showAddress:!1});var a=function(){o.nearbyShops({},function(e){t.data=t.data.concat(e),s+=e.length,s<100&&(n=!1),Utils.showView()})},c=function(){i&&_win.scrollTop()+_win.height()+10>_doc.height()&&!n&&(n=!0,a())};t.changeSort=function(e,o,r){t.showSub=0,e.id!=o&&(e.id=o,e.name=r,t.data=[],s=0,n=!1,setTimeout(c,100))},t.confirmAddress=function(){return isEmpty(t.customAddress)?void alert("请输入您的地址！"):void Utils.parseAddress(t.customAddress,function(){e.setGeo(i={address:t.customAddress,id:0}),t.showAddress=!1,c()},function(){alert("地址不存在！")})},_win.scroll(c),e.autoGeo(function(t){i=t,c()},function(){Utils.showView(),t.$apply("showAddress = true")})}]),t.controller("ShopCtrl",["$scope","GeoSvc","QuerySvc","CartSvc","LoginSvc","$routeParams","$location",function(t,e,o,r,n,s,i){var a=[];t.shopId=t.$root.cartShopId=s.id,t.cartSvc=r,t.scrollTo=function(t){$("html,body").animate({scrollTop:a[t]-43})};var c=function(){for(var e=_win.scrollTop()+180,o=a.length-1;o>=0;o--)if(a[o]<e){t.$apply("currentCat = "+o);break}},l=function(){$(".shopView .items .group").each(function(){a.push($(this).offset().top)}),_win.scroll(c),c(),Utils.showView()};o.shopProducts({},function(e){t.shop=e,t.shop.id=s.id,t.title=e.name+s.id;for(var o=0;o<e.products.length;o++)for(var n=e.products[o],i=0;i<e.categorys.length;i++){var a=e.categorys[i];a.id==n.shopCategoryId&&(!("products"in a)&&(a.products=[]),a.products.push(n))}r.update(e),setTimeout(l,100)}),t.test=function(t){var e=$(t.currentTarget).parents(".item").find("img"),o=e.offset();$("#testImg").attr("src",e.attr("src")).css({width:"54px",height:"54px",left:o.left+"px",top:o.top+"px"}).animate({width:0,height:0,left:_win.width()-45,top:_win.height()+_win.scrollTop()-35},800)},t.showProduct=function(t){}}]),t.controller("ShopDetailCtrl",["$scope","QuerySvc","$routeParams",function(t,e,o){t.title="店铺详情",e.nearbyShops({},function(e){t.shop=e[o.id%10-1],t.shop.id=o.id,Utils.showView()})}]),t.controller("SignupCtrl",["$scope","LoginSvc","$route","$location",function(t,e,o,r){t.signup=function(){if(!isEmpty([t.username,t.password,t.password2])){if(t.password!=t.password2)return void alert("密码不一致！");e.setToken({userName:t.username,userId:1,token:"test"}),t.$root.showSign=!1,"/"!=r.path()&&o.reload()}}}]),t.controller("SigninCtrl",["$scope","LoginSvc","$route","$location",function(t,e,o,r){t.username="test",t.password="test",t.signin=function(){isEmpty([t.username,t.password])||(e.setToken({userName:t.username,userId:1,token:"test"}),t.$root.showSign=!1,"/"!=r.path()&&o.reload())}}]),t.controller("AddressesCtrl",["$scope","QuerySvc","$location","LoginSvc","GeoSvc",function(t,e,o,r,n){if(r.checkToken()){var s=n.getGeo();t.title="地址管理",t.action="add",e.addresses({},function(e){s&&4==s.id&&e.push(s),t.addresses=e,Utils.showView()}),t.edit=function(t){o.url("/my/address/"+t)},t.del=function(o,r,s){o.stopPropagation(),confirm("确认删除该地址吗？")&&e.delAddress({id:r},function(e){n.clear(r),t.addresses.splice(s,1)})}}}]),t.controller("AddressCtrl",["$scope","QuerySvc","$routeParams","$location","GeoSvc","LoginSvc",function(t,e,o,r,n,s){if(s.checkToken()){if(t.title=(0==o.id?"新增":"编辑")+"收货地址",o.id>0&&o.id<4)e.addresses({},function(e){t.address=e[o.id-1],Utils.showView()});else{if(4==o.id||o.geo){var i=n.getGeo("temp"==o.geo);i&&(t.address=i)}t.address=$.extend(n.getDefault(),t.address),Utils.showView()}var a=function(e){n.setGeo(e),"home"==o.from?(r.url("/"),t.$apply()):"order"==o.from?history.go(-2):history.go(-1)};t.keyup=function(){t.address.phone=t.address.phone.replace(/\D/g,"")},t.save=function(){isEmpty(t.address)||(t.phoneErr=!/^\d+\-?\d+$/.test(t.address.phone),Utils.parseAddress(t.address.address,function(){return t.addressErr=!1,t.phoneErr?void t.$apply():(0==t.address.id&&(t.address.id=4),void a(t.address))},function(){t.addressErr=!0,t.$apply()}))}}}]),t.controller("AddressesCtrl2",["$scope","QuerySvc","GeoSvc","LoginSvc","$location","$routeParams",function(t,e,o,r,n,s){t.title="切换地址",t.from=s.from,r.checkToken(!1),t.address="";var i=o.getGeo(!1);i&&(t.address=i.address),e.addresses({},function(e){i&&4==i.id&&e.push(i),t.addresses=e,Utils.showView()}),t.confirm=function(){return isEmpty(t.address)?void alert("请输入地址！"):i&&t.address==i.address?void history.go(-1):void Utils.parseAddress(t.address,function(){o.setGeo({address:t.address}),history.go(-1)},function(){alert("地址不存在！")})},t.autoGeo=function(){$(".addressView3 .geo span").html("正在定位中"),o.autoGeo2("order"==s.from,function(e){return"order"==s.from?(n.url("/my/address/0?from=order&geo=temp"),void t.$apply()):void history.go(-1)},function(){$(".addressView3 .geo span").html("自动定位失败！")})},t.setGeo=function(t){o.setGeo(t),history.go(-1)},t.preBack=function(){return!("order"!=s.from&&!i)||(alert("请选择收货地址！"),!1)}}]),t.controller("OrderCtrl",["$scope","QuerySvc","GeoSvc","CartSvc","$location","LoginSvc",function(t,e,o,r,n,s){if(s.checkToken()){var i=r.get();if(0==r.getCount())return void n.url("/");t.geo=null;var a=o.getGeo(!1);isEmpty(a)||(t.geo=a),t.title="确认订单",t.shipTimes=[],t.shipTimeIndex=-1,t.showTime=!1,t.delivery="HOME_DELIVERY",t.payment="ONLINE",t.subTotal=r.getAmount(),e.nearbyShops({},function(e){t.shop=e[i.shop.id%10-1],Utils.showView()}),t.submit=function(){if("HOME_DELIVERY"==t.delivery&&!t.geo)return void alert("请选择收货地址！");var e=new Date,o=e.roundTime(!0);e=new Date;var r=[0,0];e.setHours(r[0]-0,r[1]-0),e.roundTime(!0),o<e.getTime()&&(o=e.getTime()),r=[23,0],e.setHours(r[0]-0,r[1]-0);for(var n=e.roundTime(!1),s=[];o+18e5<=n;)s.push(o),o+=18e5;return 0==s.length?void alert("已超过店铺配送时间，请明天再购买。"):(t.shipTimes=s,t.shipTimeIndex=0,void(t.showTime=!0))},t.submit2=function(){if(t.shipTimeIndex==-1)return void alert("请选择送货时间！");var e=r.getCount();r.clear(!0),n.path("/ordersuccess").search({count:e,amount:t.subTotal+("HOME_DELIVERY"==t.delivery?t.shop.deliveryFee:0),delivery:t.delivery,payment:t.payment})};var c=$(".summary");t.focus=function(){c.css({position:"absolute"})},t.blur=function(){c.css({position:"fixed"})}}}]),t.controller("OrderSuccessCtrl",["$scope","$routeParams","$location",function(t,e,o){e.amount-=0,t.title="购买成功",t.back="/",t.order=e,t.order.no=(new Date).getTime(),Utils.showView(),t.pay=function(){o.path("/paysuccess").search(t.order)}}]),t.controller("PaySuccessCtrl",["$scope","$routeParams",function(t,e){t.title="支付成功",t.back="/my/orders",t.order=e,setTimeout(function(){Utils.showView()},1e3)}]),t.controller("MyOrdersCtrl",["$scope","QuerySvc","$location","LoginSvc",function(t,e,o,r){if(r.checkToken()){t.title="我的订单",t.tab=0,t.data=[[],[],[],[]];var n=!1,s=[0,0,0,0],i=["","AWAIT_PAY","SHIPPED","DONE"];t.changeTab=function(e){if(t.tab!=e&&!n){var o=$(".items");o.eq(t.tab).hide(),t.tab=e,0==t.data[e].length&&0==s[e]?c(null,!0):o.eq(e).fadeIn(1e3,function(){_win.scrollTop(0)})}};var a=function(){Utils.hideView();var o=i[t.tab];e.orders({},function(e){if(o)for(var r=0;r<e.length;r++)e[r].status=o;t.data[t.tab]=t.data[t.tab].concat(e),s[t.tab]+=e.length,s[t.tab]>30&&(s[t.tab]=-1),n=!1,Utils.showView(),$(".items").eq(t.tab).fadeIn(500)})},c=function(e,o){!n&&s[t.tab]!=-1&&(o||_win.scrollTop()+_win.height()+10>_doc.height())&&(n=!0,a())};t.cancel=function(t,e){e.stopPropagation(),confirm("确定取消该订单吗？")&&(t.status="CANCELLED")},t.detail=function(t){o.url("/my/order/"+t.id)},t.comment=function(t,e){e.stopPropagation(),o.url("/my/comment/"+t.id)},t.pay=function(t,e){e.stopPropagation(),o.path("/paysuccess").search({no:t.orderNo,date:t.orderDate,count:t.items.length,amount:t.payPrice,delivery:"",payment:""})},t.confirm=function(t,e){e.stopPropagation(),confirm("确定收货吗？")&&(t.status="DONE")},_win.scroll(c),c()}}]),t.controller("MyOrderCtrl",["$scope","$routeParams","QuerySvc","LoginSvc",function(t,e,o,r){r.checkToken()&&(t.title="订单号 ",t.back="/my/orders",o.orders({},function(o){t.order=o[e.id-1],t.title+=t.order.orderNo,Utils.showView()}))}]),t.controller("CommentCtrl",["$scope","$routeParams","QuerySvc","LoginSvc",function(t,e,o,r){r.checkToken()&&(t.star=5,t.service=3,o.orders({},function(o){t.order=o[e.id-1],t.title="评论订单 "+t.order.orderNo,Utils.showView()}),t.submit=function(){history.go(-1)})}]),t.controller("MyPhoneCtrl",["$scope","QuerySvc","$timeout","LoginSvc",function(t,e,o,r){function n(){t.sec<=0||(t.sec-=1,t.sec>0&&o(n,1e3))}if(r.checkToken()){t.title="绑定手机",t.step=1,Utils.showView(),t.sec=0;var s=60,i=sessionStorage.getItem("sendTime");if(!isEmpty(i)){var a=parseInt((Utils.getCurrentTime()-i)/1e3);a<s&&(t.sec=s-a,o(n,1e3))}t.getCode=function(){if(!(t.sec>0)){if(isEmpty(t.phone)||!mobileReg.test(t.phone))return void alert("手机号为空或格式不正确！");t.sec=s,sessionStorage.setItem("sendTime",Utils.getCurrentTime()),o(n,1e3),alert("验证码已发送！")}},t.bind=function(){return isEmpty(t.code)||!codeReg.test(t.code)?void alert("验证码为空或格式不正确！"):(sessionStorage.setItem("sendTime",""),t.sec=0,t.step+=1,void(t.code=t.phone=""))}}}]),t.controller("TopTitleCtrl",["$scope","$location",function(t,e){t.$root.currentPath=e.path(),t.back=function(){t.preBack&&!t.preBack()||(t.$parent.back?e.url(t.$parent.back):history.go(-1))},t.go=function(t){e.url(t)},t.ellipsis=function(t){return t&&t.length>9&&(t="..."+t.substr(t.length-9)),t}}]),t.controller("SideBarCtrl",["$scope","LoginSvc","$location","GeoSvc",function(t,e,o,r){e.checkToken(!1),t.logout=function(){e.clearToken();r.getGeo(!1);"/"!=o.path()&&o.url("/")}}]),t.controller("CartCtrl",["$scope","CartSvc","$location","$timeout",function(t,e,o,r){t.cartSvc=e,t.delCartItem=function(t,o){$(t.target).closest(".cartItem").addClass("cartItemDel"),r(function(){e.del2(o)},300)},t.commit=function(){e.getCount()<=0||(e.save(),o.url("/order"))}}]),t.controller("AboutCtrl",["$scope",function(t){t.title="关于菜籽",Utils.showView()}]),t.controller("DeclareCtrl",["$scope",function(t){t.title="免责声明",Utils.showView()}])}(),function(){var t=angular.module("o2oServices",["ngResource"]);t.factory("GeoSvc",["$rootScope",function(t){var e={};return e.autoGeo=function(e,o){return this.getGeo(!1),t.geo?(e&&e(t.geo),t.geo):(this.autoGeo2(!1,e,o),t.geo)},e.autoGeo2=function(o,r,n){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(s){var i=e.getDefault();Utils.getAddress(s.coords.longitude,s.coords.latitude,function(e){i.address=e,o?t.tempGeo=i:Utils.setSessionItem("geo",t.geo=i),r&&r(i)},function(){o||t.$apply("address = '自动定位失败'"),n&&n()})},function(e){switch(e.code){case e.PERMISSION_DENIED:alert("您关闭了自动定位！");break;case e.POSITION_UNAVAILABLE:alert("未获取到定位坐标！");break;case e.TIMEOUT:alert("获取定位信息超时！");break;case e.UNKNOWN_ERROR:alert("定位信息-未知错误！")}o||t.$apply("address = '自动定位失败'"),n&&n()},{enableHighAccuracy:!0,timeout:1e4}):(alert("当前浏览器不支持自动定位！"),o||t.$apply("address = '当前浏览器不支持自动定位！'"),n&&n())},e.setGeo=function(o){Utils.setSessionItem("geo",t.geo=$.extend(e.getDefault(),o))},e.clear=function(e){(void 0==e||t.geo&&t.geo.id==e)&&(t.geo=null,sessionStorage.setItem("geo",""))},e.getGeo=function(e){return e?t.tempGeo:(isEmpty(t.geo)&&(t.geo=Utils.getSessionItem("geo")),t.geo)},e.getDefault=function(){return{address:"",id:0,contactName:"",phone:""}},e}]),t.factory("QuerySvc",["$resource",function(t){return t("",{},{shopProducts:{method:"GET",cache:!1,url:siteUrl+"shopProducts.json"},nearbyShops:{method:"GET",cache:!1,isArray:!0,url:siteUrl+"shopNearby.json"},product:{method:"GET",cache:!1,url:siteUrl+"product.json"},addresses:{method:"GET",cache:!1,isArray:!0,url:siteUrl+"addresses.json"},orders:{method:"GET",cache:!1,isArray:!0,url:siteUrl+"orders.json"}})}]),t.service("CartSvc",["$rootScope",function(t){var e=this,o=function(){t.cart.count=t.cart.amount=0;for(var e in t.cart.items)t.cart.count+=t.cart.items[e].quantity-0,t.cart.amount+=t.cart.items[e].quantity*t.cart.items[e].price};t.cart=Utils.getCart(),o(),e.add=function(o,r,n){r&&r.stopPropagation(),void 0==o.quantity&&(0!=t.cart.shop.id&&t.cart.shop.id!=n.id&&this.clear(),t.cart.shop={id:n.id,name:n.name},void 0==o.cart&&(o.cart={id:o.id,name:o.name,price:o.unitPrice,quantity:0}),o=o.cart),o.quantity+=1,t.cart.count+=1,t.cart.amount+=o.price,1==o.quantity&&t.cart.items.push(o),e.save()},e.del=function(o,r){if(r&&r.stopPropagation(),o.quantity-=1,t.cart.count-=1,t.cart.amount-=o.price,o.quantity<=0)for(var n in t.cart.items)if(t.cart.items[n].id==o.id){t.cart.items.splice(n,1);break}return t.cart.count<=0?void e.clear():void e.save()},e.del2=function(o){var r=t.cart.items[o];return t.cart.count-=r.quantity,t.cart.amount-=r.price*r.quantity,t.cart.items.splice(o,1),r.quantity=0,t.cart.count<=0?void e.clear():void e.save()},e.save=function(){Utils.setCart(t.cart)},e.clear=function(o){for(var r=t.cart.items.length-1;r>=0;r--)o&&!t.cart.items[r].check||(t.cart.items[r].quantity=0,t.cart.items.splice(r,1));0==t.cart.items.length&&(t.cart={count:0,amount:0,shop:{id:0},items:[]}),e.save()},e.update=function(e){if(t.cart.shop.id==e.id){var o=e.products;for(var r in t.cart.items){var n=t.cart.items[r];for(var s in o)if(o[s].id==n.id){o[s].cart=n;break}}}},e.get=function(){return t.cart},e.checkAll=function(e){for(var o in t.cart.items)t.cart.items[o].check=e},e.getAmount=function(){var e=0;for(var o in t.cart.items){var r=t.cart.items[o];r.check&&(e+=r.price*r.quantity)}return e},e.getCount=function(){var e=0;for(var o in t.cart.items){var r=t.cart.items[o];r.check&&(e+=r.quantity)}return e}}]),t.factory("LoginSvc",["$rootScope","$location",function(t,e){var o={};return o.setToken=function(e){t.user={name:e.userName,id:e.userId,token:e.token},Utils.setUser(t.user)},o.checkToken=function(e){return!!t.user||(t.user=Utils.getUser(),!!t.user||((void 0==e||e)&&(t.showSign=t.signType=!0,Utils.showView()),!1))},o.clearToken=function(){Utils.setUser(""),t.user=null},o.getUser=function(){return t.user},o}]),t.factory("ErrorInterceptors",["$q","$location","$timeout",function(t,e,o){var r=new Date,n=r.getTime();return{request:function(t){if(void 0==t.params&&(t.params={}),t.params.cdt=n,t.url.indexOf(siteUrl)!=-1){var e=new Date;t.params.dt=e.getTime()}return t}}}]),t.directive("ngMove",function(){return{controller:function(t,e,o){var r=0,n=0,s=o[0],i=function(t){t.target==s&&(r=n=t.pageX)},a=function(t){t.target==s&&(n=t.pageX)},c=function(i){if(i.target==s){"mouseup"==i.type&&(n=i.pageX);var a=n-r;t.$event={target:o,direction:a>10?1:a<-10?-1:0},t.$apply(e.ngMove)}};void 0===s.ontouchstart?(s.onmousedown=i,s.onmouseup=c):(s.ontouchstart=i,s.ontouchmove=a,s.ontouchend=c)}}}),t.directive("ngScroll",function(){return{controller:["$scope","$attrs","$element",function(t,e,o){t.$watch(e.ngScroll,function(t,e){if(void 0!=t||void 0!=e)return t==e||0==t||0==e||void 0==e?void o.html(t):t>e?void o.html(e+"<br>"+t).css("margin-top",0).animate({"margin-top":-30},300):void o.html(t+"<br>"+e).css("margin-top","-30px").animate({"margin-top":0},300)})}]}})}();var mobileReg=/^1\d{10}$/,codeReg=/^\d{4}$/;String.prototype.formatImg=function(t){if(0==this.length)return this.toString();var e=this.lastIndexOf(".");return e==-1?this.toString():this.substr(0,e)+"_"+t+"x"+t+this.substr(e)},String.prototype.getDeliveryName=function(){var t=this.toString();return"ONESELF"==t?"自提":"送货上门"},String.prototype.getPaymentName=function(){var t=this.toString();return"ONLINE"==t?"在线支付":"货到付款"},String.prototype.getOrderStatus=function(){var t=this.toString();return"CANCELLED"==t?"已取消":"AWAIT_PAY"==t?"待付款":"SHIPPED"==t?"已发货":"AWAIT_SHIPPED"==t?"待发货":"已完成"},Date.prototype.roundTime=function(t){var e=this.getMinutes();return 0==e?this.getTime():(t?e<30?this.setMinutes(30):(this.setMinutes(0),this.setHours(this.getHours()+1)):e<30?this.setMinutes(0):this.setMinutes(30),this.getTime())},$.fn.extend({touch:function(t){this.each(function(e){var o=0,r=0;this.ontouchstart=this.onmousedown=function(t){o=r=t.pageX,this.onmousemove=this.ontouchmove},this.ontouchmove=function(t){r=t.pageX},this.ontouchend=this.onmouseup=function(n){this.onmousemove=null;var s=r-o;t.call(this,e,s)}})}});var Utils={alertPop:$(".alertPop"),loading:$(".loading"),ak:"UMgv3OC6YsXrEwSFV0YBGGiO",showView:function(){this.loading.addClass("loadingHide")},hideView:function(){this.loading.removeClass("loadingHide")},getCurrentTime:function(){var t=new Date;return t.getTime()},showAlert:function(t){this.alertPop.html(t).fadeIn(200),setTimeout(function(){Utils.alertPop.fadeOut(200)},3e3)},getSessionItem:function(key){var v=sessionStorage.getItem(key);return isEmpty(v)?null:(eval("v = "+v+";"),v)},setSessionItem:function(t,e){return"object"==typeof e&&(e=angular.toJson(e)),sessionStorage.setItem(t,e),this},getCart:function(){return this.getSessionItem("cart")||{count:0,amount:0,shop:{id:0},items:[]}},setCart:function(t){return this.setSessionItem("cart",t)},getUser:function(){return this.getSessionItem("user")},setUser:function(t){return this.setSessionItem("user",t)},getAddress:function(t,e,o,r){var n=this.ak;this.hideView(),$.getJSON("https://api.map.baidu.com/geoconv/v1/?coords="+t+","+e+"&from=1&to=5&ak="+n+"&callback=?",function(t){if(0!=t.status)return r&&r(),void Utils.showView();var e=t.result[0];$.getJSON("https://api.map.baidu.com/geocoder/v2/?location="+e.y+","+e.x+"&output=json&ak="+n+"&callback=?",function(t){return Utils.showView(),0!=t.status?void(r&&r()):void o(t.result.formatted_address)})})},parseAddress:function(t,e,o){this.hideView(),$.getJSON("https://api.map.baidu.com/geocoder/v2/?address="+t+"&output=json&ak="+this.ak+"&callback=?",function(t){return Utils.showView(),0==t.status?void e():void(o&&o())})}};