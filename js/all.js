"use strict";function isNumberKey(t){var e=t.which?t.which:event.keyCode;return!(46!==e&&e>31&&(e<48||e>57))}function isEmpty(t){return null==t||void 0==t||""===t}var siteUrl="json/",o2oApp=angular.module("o2oApp",["ngRoute","o2oServices","controllers"]);o2oApp.config(["$routeProvider","$locationProvider","$httpProvider",function(t,e,r){t.when("/",{templateUrl:"partials/main.html",controller:"MainCtrl"}).when("/shop/detail/:id",{templateUrl:"partials/shopDetail.html",controller:"ShopDetailCtrl"}).when("/shop/:id/0",{templateUrl:"partials/shop.html",controller:"ShopCtrl"}).when("/product/:id/:shopId",{templateUrl:"partials/product.html",controller:"ProductCtrl"}).when("/signup",{templateUrl:"partials/signup.html",controller:"SignupCtrl"}).when("/signin",{templateUrl:"partials/signin.html",controller:"SigninCtrl"}).when("/my/addresses",{templateUrl:"partials/addresses.html",controller:"AddressesCtrl"}).when("/my/address/:id",{templateUrl:"partials/address.html",controller:"AddressCtrl"}).when("/my/phone",{templateUrl:"partials/phone.html",controller:"MyPhoneCtrl"}).when("/addresses",{templateUrl:"partials/addresses2.html",controller:"AddressesCtrl2"}).when("/order",{templateUrl:"partials/order.html",controller:"OrderCtrl"}).when("/ordersuccess",{templateUrl:"partials/orderSuccess.html",controller:"OrderSuccessCtrl"}).when("/paysuccess",{templateUrl:"partials/paySuccess.html",controller:"PaySuccessCtrl"}).when("/my/orders",{templateUrl:"partials/myOrders.html",controller:"MyOrdersCtrl"}).when("/my/order/:id",{templateUrl:"partials/myOrder.html",controller:"MyOrderCtrl"}).when("/my/comment/:id",{templateUrl:"partials/comment.html",controller:"CommentCtrl"}).when("/about",{templateUrl:"partials/about.html",controller:"AboutCtrl"}).when("/declare",{templateUrl:"partials/declare.html",controller:"DeclareCtrl"}).otherwise({redirectTo:"/"}),e.html5Mode(!1).hashPrefix("!"),r.interceptors.push("ErrorInterceptors")}]).run(["$rootScope",function(t){window._win=$(window),window._doc=$("body"),window.rootScope=t,t.apiURL=siteUrl,t.$on("$locationChangeStart",function(e){if(Utils.hideView(),t.showSideBar=t.showCartDetail=!1,t.cartShopId=-1,t.prevPath=t.currentPath||"",_win.unbind("scroll"),sessionStorage)try{sessionStorage.setItem("test","")}catch(t){alert("请取消无痕浏览！")}else alert("请升级浏览器！"),e.preventDefault()})}]),function(){var t=angular.module("controllers",[]);t.controller("MainCtrl",["$scope","GeoSvc","QuerySvc","$routeParams",function(t,e,r,o){var n=!1,i=0,s=null;$.extend(t,{data:[],cat2:{id:0,name:"全部分类"},sort2:{id:"DEFAULT",name:"默认排序"},delivery2:{id:1,name:"配送费不限"},showSub:0,showAddress:!1});var a=function(){r.nearbyShops({},function(e){t.data=t.data.concat(e),i+=e.length,i<100&&(n=!1),Utils.showView()})},c=function(){s&&_win.scrollTop()+_win.height()+10>_doc.height()&&!n&&(n=!0,a())};t.changeSort=function(e,r,o){t.showSub=0,e.id!=r&&(e.id=r,e.name=o,t.data=[],i=0,n=!1,setTimeout(c,100))},t.confirmAddress=function(){return isEmpty(t.customAddress)?void alert("请输入您的地址！"):void Utils.parseAddress(t.customAddress,function(){e.setGeo(s={address:t.customAddress,id:0}),t.showAddress=!1,c()},function(){alert("地址不存在！")})},_win.scroll(c),e.autoGeo(function(t){s=t,c()},function(){Utils.showView(),t.$apply("showAddress = true")})}]),t.controller("ShopCtrl",["$scope","GeoSvc","QuerySvc","CartSvc","LoginSvc","$routeParams","$location",function(t,e,r,o,n,i,s){var a=[];t.shopId=t.$root.cartShopId=i.id,t.back="/",t.cartSvc=o,t.scrollTo=function(t){$("html,body").animate({scrollTop:a[t]-43})};var c=function(){for(var e=_win.scrollTop()+180,r=a.length-1;r>=0;r--)if(a[r]<e){t.$apply("currentCat = "+r);break}},l=function(){$(".shopView .items .group").each(function(){a.push($(this).offset().top)}),_win.scroll(c),c(),Utils.showView()};r.shopProducts({},function(e){t.shop=e,t.shop.id=i.id,t.title=e.name+i.id;for(var r=0;r<e.products.length;r++)for(var n=e.products[r],s=0;s<e.categorys.length;s++){var a=e.categorys[s];a.id==n.shopCategoryId&&(!("products"in a)&&(a.products=[]),a.products.push(n))}o.update(e),t.showCartDetail="/order"==t.prevPath,setTimeout(l,100)}),t.test=function(t){var e=$(t.currentTarget).parents(".item").find("img"),r=e.offset();$("#testImg").attr("src",e.attr("src")).css({width:"54px",height:"54px",left:r.left+"px",top:r.top+"px"}).animate({width:0,height:0,left:_win.width()-45,top:_win.height()+_win.scrollTop()-35},800)},t.showProduct=function(t){}}]),t.controller("ShopDetailCtrl",["$scope","QuerySvc","$routeParams",function(t,e,r){t.title="店铺详情",e.nearbyShops({},function(e){t.shop=e[r.id-1],t.shop.id=r.id,Utils.showView()})}]),t.controller("SignupCtrl",["$scope","LoginSvc","$location",function(t,e,r){t.title="新用户注册",t.signup=function(){return isEmpty(t.username)?void alert("请输入用户名！"):isEmpty(t.password)?void alert("请输入密码！"):isEmpty(t.password2)?void alert("请输入确认密码！"):t.password!=t.password2?void alert("密码不一致！"):(e.setToken({userName:t.username,userId:1,token:"test"}),void r.url("/"))},Utils.showView()}]),t.controller("SigninCtrl",["$scope","LoginSvc","$location",function(t,e,r){t.title="用户登录",t.username="test",t.password="test",t.signin=function(){return isEmpty(t.username)?void alert("请输入用户名！"):isEmpty(t.password)?void alert("请输入密码！"):(e.setToken({userName:t.username,userId:1,token:"test"}),void r.url("/"))},Utils.showView()}]),t.controller("AddressesCtrl",["$scope","QuerySvc","$location",function(t,e,r){t.title="地址管理",t.action="add",e.addresses({},function(e){t.addresses=e,Utils.showView()}),t.edit=function(t){r.url("/my/address/"+t)},t.del=function(r,o,n){r.stopPropagation(),confirm("确认删除该地址吗？")&&e.delAddress({id:o},function(e){geoSvc.clear(o),t.addresses.splice(n,1)})}}]),t.controller("AddressCtrl",["$scope","QuerySvc","$routeParams","$location","GeoSvc",function(t,e,r,o,n){if(t.title=(0==r.id?"新增":"编辑")+"收货地址",t.action="save",t.address={id:r.id,defaultSet:!0},r.id>0?e.addresses({},function(e){t.address=e[r.id-1],Utils.showView()}):Utils.showView(),r.geo){var i=n.getGeo("temp"==r.geo);i&&(t.address.address=i.address)}var s=function(t){n.setGeo(t),"home"==r.from?o.url("/"):"order"==r.from?history.go(-2):history.go(-1)};t.keyup=function(){t.address.phone=t.address.phone.replace(/\D/g,"")},t.save=function(){return isEmpty(t.address.contactName)?void alert("请填写收货人姓名！"):isEmpty(t.address.address)?void alert("请填写详细地址！"):isEmpty(t.address.phone)?void alert("请填写联系电话！"):void s(t.address)}}]),t.controller("AddressesCtrl2",["$scope","QuerySvc","GeoSvc","LoginSvc","$location","$routeParams",function(t,e,r,o,n,i){t.title="切换地址","order"!=i.from&&(t.back="/"),o.checkToken(!1);var s=r.getGeo(!1);s&&(t.address=s.address),e.addresses({},function(e){t.addresses=e,Utils.showView()}),t.confirm=function(){return isEmpty(t.address)?void alert("请输入地址！"):s&&t.address==s.address?void n.url("/"):(r.setGeo({address:t.address,id:0}),void n.url("/"))},t.autoGeo=function(){$(".addressView3 .geo span").html("正在定位中"),Utils.hideView(),r.autoGeo2("order"==i.from,function(e){n.url("order"==i.from?"/my/address/0?from=order&geo=temp":t.back),t.$apply()},function(){$(".addressView3 .geo span").html("自动定位失败！"),Utils.showView()})},t.setGeo=function(e){r.setGeo(e),t.back?n.url(t.back):history.go(-1)},t.preBack=function(){return"order"==i.from||!isEmpty(s)||(alert("请选择收货地址！"),!1)}}]),t.controller("OrderCtrl",["$scope","QuerySvc","GeoSvc","CartSvc","$location",function(t,e,r,o,n){var i=o.get();if(0==o.getCount())return void n.url("/");t.geo=null;var s=r.getGeo(!1);!isEmpty(s)&&s.contactName&&(t.geo=s),t.title="确认订单",t.back="/shop/"+i.shop.id+"/0",t.cartSvc=o,t.shipTimes=[],t.shipTimeIndex=-1,t.showTime=!1,t.delivery="HOME_DELIVERY",t.payment="ONLINE",t.subTotal=o.getAmount(),Utils.showView(),t.submit=function(){if("HOME_DELIVERY"==t.delivery&&!t.geo)return void alert("请选择收货地址！");var e=new Date,r=e.roundTime(!0);e=new Date;var o=[0,0];e.setHours(o[0]-0,o[1]-0),e.roundTime(!0),r<e.getTime()&&(r=e.getTime()),o=[23,0],e.setHours(o[0]-0,o[1]-0);for(var n=e.roundTime(!1),i=[];r+18e5<=n;)i.push(r),r+=18e5;return 0==i.length?void alert("已超过店铺配送时间，请明天再购买。"):(t.shipTimes=i,t.shipTimeIndex=0,void(t.showTime=!0))},t.submit2=function(){if(t.shipTimeIndex==-1)return void alert("请选择送货时间！");var e=o.getCount();o.clear(!0),n.path("/ordersuccess").search({count:e,amount:t.subTotal+5,delivery:t.delivery,payment:t.payment})};var a=$(".summary");t.focus=function(){a.css({position:"absolute"})},t.blur=function(){a.css({position:"fixed"})}}]),t.controller("OrderSuccessCtrl",["$scope","$routeParams","$location",function(t,e,r){e.amount-=0,t.title="购买成功",t.back="/",t.order=e,t.order.date=new Date,t.order.no=t.order.date.getTime(),Utils.showView(),t.pay=function(){r.path("/paysuccess").search(t.order)}}]),t.controller("PaySuccessCtrl",["$scope","$routeParams",function(t,e){t.title="支付成功",t.back="/my/orders",t.order=e,Utils.showView()}]),t.controller("MyOrdersCtrl",["$scope","QuerySvc","$location",function(t,e,r){t.title="我的订单",t.tab=0,t.data=[[],[],[],[]];var o=!1,n=[0,0,0,0],i=["","AWAIT_PAY","AWAIT_SHIPPED","SHIPPED"];t.changeTab=function(e){if(t.tab!=e&&!o){var r=$(".items");r.eq(t.tab).hide(),t.tab=e,0==t.data[e].length&&0==n[e]?a(null,!0):r.eq(e).fadeIn(1e3,function(){_win.scrollTop(0)})}};var s=function(){Utils.hideView();var r=i[t.tab];e.orders({},function(e){if(r)for(var i=0;i<e.length;i++)e[i].status=r;t.data[t.tab]=t.data[t.tab].concat(e),n[t.tab]+=e.length,n[t.tab]>30&&(n[t.tab]=-1),o=!1,Utils.showView(),$(".items").eq(t.tab).fadeIn(500)})},a=function(e,r){!o&&n[t.tab]!=-1&&(r||_win.scrollTop()+_win.height()+10>_doc.height())&&(o=!0,s())};t.cancel=function(t,e){e.stopPropagation(),confirm("确定取消该订单吗？")&&(t.status="CANCELLED")},t.detail=function(t){r.url("/my/order/"+t.id)},t.comment=function(t,e){e.stopPropagation(),r.url("/my/comment/"+t.id)},t.pay=function(t,e){e.stopPropagation(),r.path("/paysuccess").search({no:t.orderNo,date:t.orderDate,count:t.items.length,amount:t.payPrice,delivery:"",payment:""})},_win.scroll(a),a()}]),t.controller("MyOrderCtrl",["$scope","$routeParams","QuerySvc",function(t,e,r){t.title="订单号 ",t.back="/my/orders",r.orders({},function(r){t.order=r[e.id-1],t.title+=t.order.orderNo,Utils.showView()})}]),t.controller("CommentCtrl",["$scope","$routeParams","QuerySvc",function(t,e,r){t.star=5,t.service=3,r.orders({},function(r){t.order=r[e.id-1],t.title="评论订单 "+t.order.orderNo,Utils.showView()}),t.submit=function(){history.go(-1)}}]),t.controller("MyPhoneCtrl",["$scope","QuerySvc","$timeout",function(t,e,r){function o(){t.sec<=0||(t.sec-=1,t.sec>0&&r(o,1e3))}t.title="绑定手机",t.step=1,Utils.showView(),t.sec=0;var n=60,i=sessionStorage.getItem("sendTime");if(!isEmpty(i)){var s=parseInt((Utils.getCurrentTime()-i)/1e3);s<n&&(t.sec=n-s,r(o,1e3))}t.getCode=function(){if(!(t.sec>0)){if(isEmpty(t.phone))return void alert("请填写您的手机号！");t.sec=n,sessionStorage.setItem("sendTime",Utils.getCurrentTime()),r(o,1e3),alert("验证码已发送！")}},t.bind=function(){return isEmpty(t.code)?void alert("请填写验证码！"):(sessionStorage.setItem("sendTime",""),t.sec=0,t.step+=1,void(t.code=t.phone=""))}}]),t.controller("TopTitleCtrl",["$scope","$location",function(t,e){t.$root.currentPath=e.path(),t.back=function(){t.preBack&&!t.preBack()||(t.$parent.back?e.url(t.$parent.back):history.go(-1))},t.go=function(t){e.url(t)},t.ellipsis=function(t){return t&&t.length>9&&(t="..."+t.substr(t.length-9)),t}}]),t.controller("SideBarCtrl",["$scope","LoginSvc","$location","GeoSvc",function(t,e,r,o){e.checkToken(!1),t.logout=function(){e.clearToken();o.getGeo(!1);"/"!=r.path()&&r.url("/")}}]),t.controller("CartCtrl",["$scope","CartSvc","$location","$timeout",function(t,e,r,o){t.cartSvc=e,t.delCartItem=function(t,r){$(t.target).closest(".cartItem").addClass("cartItemDel"),o(function(){e.del2(r)},300)},t.commit=function(){e.getCount()<=0||(e.save(),r.url("/order"))}}]),t.controller("AboutCtrl",["$scope",function(t){t.title="关于菜籽",Utils.showView()}]),t.controller("DeclareCtrl",["$scope",function(t){t.title="免责声明",Utils.showView()}])}(),function(){var t=angular.module("o2oServices",["ngResource"]);t.factory("GeoSvc",["$rootScope",function(t){var e={};return e.autoGeo=function(e,r){return this.getGeo(!1),t.geo?(e&&e(t.geo),t.geo):(this.autoGeo2(!1,e,r),t.geo)},e.autoGeo2=function(e,r,o){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(n){var i={lat:n.coords.latitude,lng:n.coords.longitude,id:0};Utils.getAddress(i.lng,i.lat,function(o){i.address=o,e?t.tempGeo=i:Utils.setSessionItem("geo",t.geo=i),r&&r(i)},function(){e||t.$apply("address = '自动定位失败'"),o&&o()})},function(r){switch(r.code){case r.PERMISSION_DENIED:alert("您关闭了自动定位！");break;case r.POSITION_UNAVAILABLE:alert("未获取到定位坐标！");break;case r.TIMEOUT:alert("获取定位信息超时！");break;case r.UNKNOWN_ERROR:alert("定位信息-未知错误！")}e||t.$apply("address = '自动定位失败'"),o&&o()},{enableHighAccuracy:!0,timeout:1e4}):(alert("当前浏览器不支持自动定位！"),e||t.$apply("address = '当前浏览器不支持自动定位！'"),o&&o())},e.setGeo=function(e){t.geo={lat:e.latitude||e.lat,lng:e.longitude||e.lng,address:e.address,id:e.id||0,contactName:e.contactName||"",phone:e.phone||""},Utils.setSessionItem("geo",t.geo)},e.clear=function(e){(void 0==e||t.geo&&t.geo.id==e)&&(t.geo=null,sessionStorage.setItem("geo",""))},e.getGeo=function(e){return e?t.tempGeo:(isEmpty(t.geo)&&(t.geo=Utils.getSessionItem("geo")),t.geo)},e}]),t.factory("QuerySvc",["$resource",function(t){return t("",{},{shopProducts:{method:"GET",cache:!1,url:siteUrl+"shopProducts.json"},nearbyShops:{method:"GET",cache:!1,isArray:!0,url:siteUrl+"shopNearby.json"},product:{method:"GET",cache:!1,url:siteUrl+"product.json"},addresses:{method:"GET",cache:!1,isArray:!0,url:siteUrl+"addresses.json"},orders:{method:"GET",cache:!1,isArray:!0,url:siteUrl+"orders.json"}})}]),t.service("CartSvc",["$rootScope",function(t){var e=this,r=function(){t.cart.count=t.cart.amount=0;for(var e in t.cart.items)t.cart.count+=t.cart.items[e].quantity-0,t.cart.amount+=t.cart.items[e].quantity*t.cart.items[e].price};t.cart=Utils.getCart(),r(),e.add=function(r,o,n){o&&o.stopPropagation(),void 0==r.quantity&&(0!=t.cart.shop.id&&t.cart.shop.id!=n.id&&this.clear(),t.cart.shop={id:n.id,name:n.name},void 0==r.cart&&(r.cart={id:r.id,name:r.name,price:r.unitPrice,quantity:0}),r=r.cart),r.quantity+=1,t.cart.count+=1,t.cart.amount+=r.price,1==r.quantity&&t.cart.items.push(r),e.save()},e.del=function(r,o){if(o&&o.stopPropagation(),r.quantity-=1,t.cart.count-=1,t.cart.amount-=r.price,r.quantity<=0)for(var n in t.cart.items)if(t.cart.items[n].id==r.id){t.cart.items.splice(n,1);break}return t.cart.count<=0?void e.clear():void e.save()},e.del2=function(r){var o=t.cart.items[r];return t.cart.count-=o.quantity,t.cart.amount-=o.price*o.quantity,t.cart.items.splice(r,1),o.quantity=0,t.cart.count<=0?void e.clear():void e.save()},e.save=function(){Utils.setCart(t.cart)},e.clear=function(r){for(var o=t.cart.items.length-1;o>=0;o--)r&&!t.cart.items[o].check||(t.cart.items[o].quantity=0,t.cart.items.splice(o,1));0==t.cart.items.length&&(t.cart={count:0,amount:0,shop:{id:0},items:[]}),e.save()},e.update=function(e){if(t.cart.shop.id==e.id){var r=e.products;for(var o in t.cart.items){var n=t.cart.items[o];for(var i in r)if(r[i].id==n.id){r[i].cart=n;break}}}},e.get=function(){return t.cart},e.checkAll=function(e){for(var r in t.cart.items)t.cart.items[r].check=e},e.getAmount=function(){var e=0;for(var r in t.cart.items){var o=t.cart.items[r];o.check&&(e+=o.price*o.quantity)}return e},e.getCount=function(){var e=0;for(var r in t.cart.items){var o=t.cart.items[r];o.check&&(e+=o.quantity)}return e}}]),t.factory("LoginSvc",["$rootScope","$location",function(t,e){var r={};return r.setToken=function(e){t.user={name:e.userName,id:e.userId,token:e.token},Utils.setUser(t.user)},r.checkToken=function(r){return!!t.user||(t.user=Utils.getUser(),!!t.user||((void 0==r||r)&&e.url("/signin"),!1))},r.clearToken=function(){Utils.setUser(""),t.user=null},r.getUser=function(){return t.user},r}]),t.factory("ErrorInterceptors",["$q","$location","$timeout",function(t,e,r){var o=new Date,n=o.getTime();return{request:function(t){if(void 0==t.params&&(t.params={}),t.params.cdt=n,t.url.indexOf(siteUrl)!=-1){var e=new Date;t.params.dt=e.getTime()}return t}}}]),t.directive("ngMove",function(){return{controller:function(t,e,r){var o=0,n=0,i=r[0],s=function(t){t.target==i&&(o=n=t.pageX)},a=function(t){t.target==i&&(n=t.pageX)},c=function(s){if(s.target==i){"mouseup"==s.type&&(n=s.pageX);var a=n-o;t.$event={target:r,direction:a>10?1:a<-10?-1:0},t.$apply(e.ngMove)}};void 0===i.ontouchstart?(i.onmousedown=s,i.onmouseup=c):(i.ontouchstart=s,i.ontouchmove=a,i.ontouchend=c)}}}),t.directive("ngScroll",function(){return{controller:["$scope","$attrs","$element",function(t,e,r){t.$watch(e.ngScroll,function(t,e){if(void 0!=t||void 0!=e)return t==e||0==t||0==e||void 0==e?void r.html(t):t>e?void r.html(e+"<br>"+t).css("margin-top",0).animate({"margin-top":-30},300):void r.html(t+"<br>"+e).css("margin-top","-30px").animate({"margin-top":0},300)})}]}})}(),String.prototype.formatImg=function(t){if(0==this.length)return this.toString();var e=this.lastIndexOf(".");return e==-1?this.toString():this.substr(0,e)+"_"+t+"x"+t+this.substr(e)},String.prototype.getDeliveryName=function(){var t=this.toString();return"ONESELF"==t?"自提":"送货上门"},String.prototype.getPaymentName=function(){var t=this.toString();return"ONLINE"==t?"在线支付":"货到付款"},String.prototype.getOrderStatus=function(){var t=this.toString();return"CANCELLED"==t?"已取消":"AWAIT_PAY"==t?"待付款":"SHIPPED"==t?"已发货":"AWAIT_SHIPPED"==t?"待发货":"已完成"},Date.prototype.roundTime=function(t){var e=this.getMinutes();return 0==e?this.getTime():(t?e<30?this.setMinutes(30):(this.setMinutes(0),this.setHours(this.getHours()+1)):e<30?this.setMinutes(0):this.setMinutes(30),this.getTime())},$.fn.extend({touch:function(t){this.each(function(e){var r=0,o=0;this.ontouchstart=this.onmousedown=function(t){r=o=t.pageX,this.onmousemove=this.ontouchmove},this.ontouchmove=function(t){o=t.pageX},this.ontouchend=this.onmouseup=function(n){this.onmousemove=null;var i=o-r;t.call(this,e,i)}})}});var Utils={alertPop:$(".alertPop"),loading:$(".loading"),ak:"UMgv3OC6YsXrEwSFV0YBGGiO",showView:function(){this.loading.addClass("loadingHide")},hideView:function(){this.loading.removeClass("loadingHide")},getCurrentTime:function(){var t=new Date;return t.getTime()},showAlert:function(t){this.alertPop.html(t).fadeIn(200),setTimeout(function(){Utils.alertPop.fadeOut(200)},3e3)},getSessionItem:function(key){var v=sessionStorage.getItem(key);return isEmpty(v)?null:(eval("v = "+v+";"),v)},setSessionItem:function(t,e){return"object"==typeof e&&(e=angular.toJson(e)),sessionStorage.setItem(t,e),this},getCart:function(){return this.getSessionItem("cart")||{count:0,amount:0,shop:{id:0},items:[]}},setCart:function(t){return this.setSessionItem("cart",t)},getUser:function(){return this.getSessionItem("user")},setUser:function(t){return this.setSessionItem("user",t)},getAddress:function(t,e,r,o){var n=this.ak;$.getJSON("https://api.map.baidu.com/geoconv/v1/?coords="+t+","+e+"&from=1&to=5&ak="+n+"&callback=?",function(t){if(0!=t.status)return void(o&&o());var e=t.result[0];$.getJSON("https://api.map.baidu.com/geocoder/v2/?location="+e.y+","+e.x+"&output=json&ak="+n+"&callback=?",function(t){return 0!=t.status?void(o&&o()):void r(t.result.formatted_address)})})},parseAddress:function(t,e,r){$.getJSON("https://api.map.baidu.com/geocoder/v2/?address="+t+"&output=json&ak="+this.ak+"&callback=?",function(t){return 0==t.status?void e():void(r&&r())})}};